<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/codedellemc/rexray/user-guide/demo/">
        <link rel="shortcut icon" href="favicon.png">
        

	<title>Demo - REX-Ray</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/emccode.css" rel="stylesheet">
        <link href="../../css/emccode-font.css" rel="stylesheet">
        <link href="../../css/hX.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        

        <!-- scroll fix -->
        <script>
            //var shiftWindow = function() { scrollBy(0, -40) };
            //if (location.hash) shiftWindow();
            //window.addEventListener("hashchange", shiftWindow);
        </script>

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">
                <i class="fa icon-rexray-logo"></i>
                REX-Ray
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../config/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../storage-providers/">Storage Providers</a>
                        </li>
                    
                        <li >
                            <a href="../schedulers/">Schedulers</a>
                        </li>
                    
                        <li >
                            <a href="../docker-plugins/">Docker Plug-ins</a>
                        </li>
                    
                        <li >
                            <a href="../applications/">Applications</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Demo</a>
                        </li>
                    
                        <li >
                            <a href="../troubleshooting/">Troubleshooting</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">User Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../installation/">Installation</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../config/">Configuration</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../storage-providers/">Storage Providers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../schedulers/">Schedulers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../docker-plugins/">Docker Plug-ins</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../applications/">Applications</a>
                        </li>
                    
                    
                    
                        <li class="active">
                            <a href="./">Demo</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../troubleshooting/">Troubleshooting</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../dev-guide/project-guidelines/">Project Guidelines</a>
                        </li>
                    
                        <li >
                            <a href="../../dev-guide/build-reference/">Build Reference</a>
                        </li>
                    
                        <li >
                            <a href="../../dev-guide/release-process/">Release Process</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">Developers Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../dev-guide/project-guidelines/">Project Guidelines</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../dev-guide/build-reference/">Build Reference</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../dev-guide/release-process/">Release Process</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">About <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../applications/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../troubleshooting/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/codedellemc/rexray.git">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
                <li>
                    <a href="https://emccode.github.io">
                        <i class="fa icon-emccode-logo"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
        <div class="container ">
            <div class="col-md-3"><div id="sidenav" class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#demo">Demo</a></li>
        
            <li><a href="#two-node-clientserver">Two-Node Client/Server</a>
            
                <ul class="nav nav-stacked">
                
                <li><a href="#start-rex-ray-vagrant-environment">Start REX-Ray Vagrant Environment</a><!--
                -->
                </li>
                
                <li><a href="#node-0">Node 0</a><!--
                -->
                </li>
                
                <li><a href="#node-1">Node 1</a><!--
                -->
                </li>
                
                <li><a href="#cleaning-up">Cleaning Up</a><!--
                -->
                </li>
                
                <li><a href="#congratulations">Congratulations</a><!--
                -->
                </li>
                
                </ul>
            
            </li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="demo">Demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h1>
<p>Easy as 1, 2, 3...</p>
<hr />
<h2 id="two-node-clientserver">Two-Node Client/Server<a class="headerlink" href="#two-node-clientserver" title="Permanent link">&para;</a></h2>
<p>This demo consists of a two-node deployment with the first node configured as a
REX-Ray/libStorage server and the second node as merely a client. Both nodes
have Docker installed and configured to leverage REX-Ray for persistent storage.</p>
<p>The below example does have a few requirements:</p>
<ul>
<li>VirtualBox 5.0+</li>
<li>Vagrant 1.8+</li>
<li>Ruby 2.0+</li>
</ul>
<h3 id="start-rex-ray-vagrant-environment">Start REX-Ray Vagrant Environment<a class="headerlink" href="#start-rex-ray-vagrant-environment" title="Permanent link">&para;</a></h3>
<p>Before bringing the Vagrant environment online, please ensure it is accomplished
in a clean directory</p>
<pre><code class="sh">$ cd $(mktemp -d)
</code></pre>

<p>Inside the newly created, temporary directory, download the REX-Ray
<a href="https://github.com/emccode/rexray/master/Vagrantfile">Vagrantfile</a>:</p>
<pre><code class="sh">$ curl -fsSLO https://raw.githubusercontent.com/emccode/rexray/master/Vagrantfile
</code></pre>

<p>Now it is time to bring the REX-Ray environment online:</p>
<div class="admonition note">
<p class="admonition-title">note</p>
<p>The next step could potentially open up the system on which the command is
executed to security vulnerabilities. The Vagrantfile brings the VirtualBox
web service online if it is not already running. However, in the name of
simplicity the Vagrantfile also disables the web server's authentication
module. Please do not disable authentication for the VirtualBox web server
if this example is being executed on an open network or without some type of
firewall in place.</p>
</div>
<pre><code class="sh">$ vagrant up
</code></pre>

<p>The above command should result in output similar to <a href="https://gist.github.com/akutz/13fc3b2237ea2c295a25c2e367e6bd8f">this
Gist</a>.</p>
<p>Once the command has been completed successfully there will be two VMs online
named <code>node0</code> and <code>node1</code>. Both nodes are running Docker and REX-Ray with
<code>node0</code> configured to act as a libStorage server.</p>
<p>Now that the environment is online it is time to showcase Docker leveraging REX-
Ray to create persistent storage as well as illustrating REX-Ray's distributed
deployment capabilities.</p>
<h3 id="node-0">Node 0<a class="headerlink" href="#node-0" title="Permanent link">&para;</a></h3>
<p>First, SSH into <code>node0</code></p>
<pre><code class="sh">$ vagrant ssh node0
</code></pre>

<p>From <code>node0</code> use Docker with REX-Ray to create a new volume named
<code>hellopersistence</code>:</p>
<pre><code class="sh">vagrant@node0:~$ docker volume create --driver rexray --opt size=1 \
                 --name hellopersistence
</code></pre>

<p>After the volume is created, mount it to the host and container using the
<code>--volume-driver</code> and <code>-v</code> flag in the <code>docker run</code> command:</p>
<pre><code class="sh">vagrant@node0:~$ docker run -tid --volume-driver=rexray \
                 -v hellopersistence:/mystore \
                 --name temp01 busybox
</code></pre>

<p>Create a new file named <code>myfile</code> on the file system backed by the persistent
volume using <code>docker exec</code>:</p>
<pre><code class="sh">vagrant@node0:~$ docker exec temp01 touch /mystore/myfile
</code></pre>

<p>Verify the file was successfully created by listing the contents of the
persistent volume:</p>
<pre><code class="sh">vagrant@node0:~$ docker exec temp01 ls /mystore
</code></pre>

<p>Remove the container that was used to write the data to the persistent volume:</p>
<pre><code class="sh">vagrant@node0:~$ docker rm -f temp01
</code></pre>

<p>Finally, exit the SSH session to <code>node0</code>:</p>
<pre><code class="sh">vagrant@node0:~$ exit
</code></pre>

<h3 id="node-1">Node 1<a class="headerlink" href="#node-1" title="Permanent link">&para;</a></h3>
<p>It's time to connect to <code>node1</code> and use the volume <code>hellopersistence</code> that was
created in the previous section from <code>node0</code>.</p>
<div class="admonition note">
<p class="admonition-title">note</p>
<p>While <code>node1</code> runs both the Docker and REX-Ray services like <code>node0</code>, the
REX-Ray service on <code>node1</code> in no way understands or is configured for the
VirtualBox storage driver. All interactions with the VirtualBox web service
occurs via <code>node0</code>'s libStorage server with which <code>node1</code> communicates.</p>
</div>
<p>Use the vagrant command to SSH into <code>node1</code>:</p>
<pre><code class="sh">$ vagrant ssh node1
</code></pre>

<p>Next, create a new container that mounts the existing volume,
<code>hellopersistence</code>:</p>
<pre><code class="sh">vagrant@node1:~$ docker run -tid --volume-driver=rexray \
                 -v hellopersistence:/mystore \
                 --name temp01 busybox
</code></pre>

<p>The next command validates the file <code>myfile</code> created from <code>node0</code> in the
previous section has persisted inside the volume across machines:</p>
<pre><code class="sh">vagrant@node1:~$ docker exec temp01 ls /mystore
</code></pre>

<p>Finally, exit the SSH session to <code>node1</code>:</p>
<pre><code class="sh">vagrant@node1:~$ exit
</code></pre>

<h3 id="cleaning-up">Cleaning Up<a class="headerlink" href="#cleaning-up" title="Permanent link">&para;</a></h3>
<p>Be sure to kill the VirtualBox web server with a quick <code>killall vboxwebsrv</code> and
to tear down the Vagrant environment with <code>vagrant destroy</code>. Omitting these
commands will leave the web service and REX-Ray Vagrant nodes online and consume
additional system resources.</p>
<h3 id="congratulations">Congratulations<a class="headerlink" href="#congratulations" title="Permanent link">&para;</a></h3>
<p>REX-Ray has been used to provide persistence for stateless containers! Examples
using MongoDB, Postgres, and more with persistent storage can be found at
<a href="../applications/">Application Examples</a> or within the <a href="https://github.com/codedellemc/labs">{code} Labs
repo</a>.</p></div>
        </div>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <!--
        <script src="../../.themes/yeti/js/base.js"></script>
        <script src="../../.themes/yeti/js/bootstrap-3.0.3.min.js"></script>
        <script src="../../.themes/yeti/js/highlight.pack.js"></script>
        <script src="../../.themes/yeti/js/jquery-1.10.2.min.js"></script>
        -->
    </body>

</html>