<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/emccode/rexray/dev-guide/build-reference/">
        <link rel="shortcut icon" href="../../favicon.png">
        

	<title>Build Reference - REX-Ray</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/emccode-font.css" rel="stylesheet">
        <link href="../../css/hX.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        

        <!-- scroll fix -->
        <script>
            //var shiftWindow = function() { scrollBy(0, -40) };
            //if (location.hash) shiftWindow();
            //window.addEventListener("hashchange", shiftWindow);
        </script>

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">
                <i class="fa icon-rexray-logo"></i>
                REX-Ray
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../user-guide/installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/config/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/storage-providers/">Storage Providers</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/schedulers/">Schedulers</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/application/">Applications</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">User Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../user-guide/installation/">Installation</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/config/">Configuration</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/storage-providers/">Storage Providers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/schedulers/">Schedulers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/application/">Applications</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../project-guidelines/">Project Guidelines</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Build Reference</a>
                        </li>
                    
                        <li >
                            <a href="../release-process/">Release Process</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">Developers Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../project-guidelines/">Project Guidelines</a>
                        </li>
                    
                    
                    
                        <li class="active">
                            <a href="./">Build Reference</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../release-process/">Release Process</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">About <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../project-guidelines/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../release-process/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/emccode/rexray.git">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
                <li>
                    <a href="https://emccode.github.io">
                        <i class="fa icon-emccode-logo"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
        <div class="container ">
            <div class="col-md-3"><div id="sidenav" class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#build-reference">Build Reference</a></li>
        
            <li><a href="#build-requirements">Build Requirements</a>
            
            </li>
        
            <li><a href="#cross-compilation">Cross-Compilation</a>
            
            </li>
        
            <li><a href="#build-binary">Build Binary</a>
            
                <ul class="nav nav-stacked">
                
                <li><a href="#basic-build">Basic Build</a><!--
                -->
                </li>
                
                <li><a href="#binary-size">Binary Size</a><!--
                -->
                </li>
                
                <li><a href="#build-all">Build All</a><!--
                -->
                </li>
                
                </ul>
            
            </li>
        
            <li><a href="#build-packages">Build Packages</a>
            
                <ul class="nav nav-stacked">
                
                <li><a href="#build-tarballs">Build Tarballs</a><!--
                -->
                </li>
                
                <li><a href="#build-rpms">Build RPMs</a><!--
                -->
                </li>
                
                <li><a href="#build-debs">Build DEBs</a><!--
                -->
                </li>
                
                </ul>
            
            </li>
        
            <li><a href="#version-file">Version File</a>
            
            </li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="build-reference">Build Reference</h1>
<p>How to build REX-Ray</p>
<hr />
<h2 id="build-requirements">Build Requirements</h2>
<p>This project has very few build requirements, but there are still one or two
items of which to be aware. Also, please note that this are the requirements to
<em>build</em> <code>REX-Ray</code>, not run it.</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Operating System</td>
<td>Linux, OS X</td>
</tr>
<tr>
<td><a href="https://golang.org/">Go</a></td>
<td>&gt;=1.5</td>
</tr>
<tr>
<td><a href="https://www.gnu.org/software/make/">GNU Make</a></td>
<td>&gt;=3.80</td>
</tr>
</tbody>
</table>
<p>OS X ships with a very old version of GNU Make, and a package manager like
<a href="http://brew.sh/">Homebrew</a> can be used to install the required version.</p>
<h2 id="cross-compilation">Cross-Compilation</h2>
<p>This project's <a href="https://github.com/emccode/rexray/blob/master/Makefile"><code>Makefile</code></a>
is configured by default to cross-compile for Linux x86 &amp; x86_64 as well as
Darwin (OS X) x86_64. Therefore the build process will fail if the local Go
environment is not set up for cross-compilation. Please take a minute to read
this <a href="http://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5">blog post</a>
regarding cross-compilation with Go &gt;=1.5.</p>
<h2 id="build-binary">Build Binary</h2>
<p>Building from source is pretty simple as all steps, including fetching
dependencies (as well as fetching the tool that fetches dependencies), are
configured as part of the included <code>Makefile</code>.</p>
<h3 id="basic-build">Basic Build</h3>
<p>The most basic build can be achieved by simply typing <code>make</code> from the project's
root directory. For what it's worth, executing <code>make</code> sans arguments is the
same as executing <code>make install</code> for this project's <code>Makefile</code>.</p>
<pre><code class="sh">$ make
SemVer: 0.3.1-rc1+8+dirty
RpmVer: 0.3.1+rc1+8+dirty
Branch: feature/dev-guide
Commit: ea59957557d01725ec147d5f71ce6a30aa8698e9
Formed: Wed, 16 Dec 2015 14:58:33 CST

target: deps
  ...installing glide...SUCCESS!
  ...downloading go dependencies...SUCCESS!
target: fmt
  ...formatting rexray...SUCCESS!
target: install
  ...installing rexray Darwin-x86_64...SUCCESS!

The REX-Ray binary is 62MB and located at:

  /Users/akutz/Projects/go/bin/rexray
</code></pre>

<h3 id="binary-size">Binary Size</h3>
<p>Please note that the extraordinary size of the binary is due to the Isilon
storage adapter's dependency on the
<a href="https://github.com/vmware/govmomi">VMware VMOMI library for Go</a>. The types
definition source in that package compiles to a 45MB archive. We're currently
working to figure out an alternative to this, even if it means creating VMware
SOAP messages from scratch.</p>
<h3 id="build-all">Build All</h3>
<p>In order to build all versions of the binary type the following:</p>
<pre><code class="sh">$ make build-all
SemVer: 0.3.1-rc1+8+dirty
RpmVer: 0.3.1+rc1+8+dirty
Branch: feature/dev-guide
Commit: ea59957557d01725ec147d5f71ce6a30aa8698e9
Formed: Wed, 16 Dec 2015 15:03:27 CST

target: deps
  ...installing glide...SUCCESS!
  ...downloading go dependencies...SUCCESS!
target: fmt
  ...formatting rexray...SUCCESS!
target: build
  ...building rexray Linux-i386...SUCCESS!

The REX-Ray binary is 53MB and located at:

  .build/bin/Linux-i386/rexray

target: build
  ...building rexray Linux-x86_64...SUCCESS!

The REX-Ray binary is 62MB and located at:

  .build/bin/Linux-x86_64/rexray

target: build
  ...building rexray Darwin-x86_64...SUCCESS!

The REX-Ray binary is 62MB and located at:

  .build/bin/Darwin-x86_64/rexray
</code></pre>

<h2 id="build-packages">Build Packages</h2>
<p>The <code>Makefile</code> also includes targets that assist in the creation of
distributable packages using the produced artifact.</p>
<h3 id="build-tarballs">Build Tarballs</h3>
<p>The <code>Makefile</code>'s <code>build</code> and <code>build-all</code> targets will not only build the binary
in place, but it will also compress the binary as a tarball so it's ready for
deployment. For example, after the <code>make build-all</code> above, this is the contents
of the directory <code>.build/deploy</code>:</p>
<pre><code class="sh">$ ls .build/deploy
Darwin-x86_64/
Linux-i386/
Linux-x86_64/
latest/
</code></pre>

<p>Looking inside the directory <code>.build/deploy/Linux-x86_64</code> reveals:</p>
<pre><code class="sh">$ ls .build/deploy/Linux-x86_64/
rexray-Linux-x86_64-0.3.1-rc1+8+dirty.tar.gz
</code></pre>

<h3 id="build-rpms">Build RPMs</h3>
<p>The <code>Makefile</code>'s <code>rpm-all</code> target will package the binary as
architecture-specific RPMs when executed on a system that supports the RPM
development environment:</p>
<pre><code class="sh">$ make rpm-all
target: rpm
  ...building rpm i386...SUCCESS!

The REX-Ray RPM is 6MB and located at:

  .build/deploy/Linux-i386/rexray-0.3.1+rc1+8+dirty-1.i386.rpm

target: rpm
  ...building rpm x86_64...SUCCESS!

The REX-Ray RPM is 7MB and located at:

  .build/deploy/Linux-x86_64/rexray-0.3.1+rc1+8+dirty-1.x86_64.rpm
</code></pre>

<h3 id="build-debs">Build DEBs</h3>
<p>The <code>Makefile</code>'s <code>deb-all</code> target will package the binary as
architecture-specific DEBs when executed on a system that supports the Alien
RPM-to-DEB conversion tools:</p>
<pre><code class="sh">$ make deb-all
target: deb
  ...building deb x86_64...SUCCESS!

The REX-Ray DEB is 4MB and located at:

  .build/deploy/Linux-x86_64/rexray_0.3.1+rc1+8+dirty-1_amd64.deb
</code></pre>

<h2 id="version-file">Version File</h2>
<p>There is a file at the root of the project named <code>VERSION</code>. The file contains
a single line with the <em>target</em> version of the project in the file. The version
follows the format:</p>
<p><code>(?&lt;major&gt;\d+)\.(?&lt;minor&gt;\d+)\.(?&lt;patch&gt;\d+)(-rc\d+)?</code></p>
<p>For example, during active development of version <code>0.4.0</code> the file would
contain the version <code>0.4.0</code>. When it's time to create <code>0.4.0</code>'s first
release candidate the version in the file will be changed to <code>0.4.0-rc1</code>. And
when it's time to release <code>0.4.0</code> the version is changed back to <code>0.4.0</code>.</p>
<p>Please note that we've discussed making the actively developed version the
targeted version with a <code>-dev</code> suffix, but trying this resulted in confusion
for the RPM and DEB package managers when using <code>unstable</code> releases.</p>
<p>So what's the point of the file if it's basically duplicating the utility of a
tag? Well, the <code>VERSION</code> file in fact has two purposes:</p>
<ol>
<li>
<p>First and foremost updating the <code>VERSION</code> file with the same value as that
     of the tag used to create a release provides a single, contextual reason to
     push a commit and tag. Otherwise some random commit off of <code>master</code> would
     be tagged as a release candidate or release. Always using the commit that
     is related to updating the <code>VERSION</code> file is much cleaner.</p>
</li>
<li>
<p>The contents of the <code>VERSION</code> file are also used during the build process
     as a means of overriding the output of a <code>git describe</code>. This enables the
     semantic version injected into the produced binary to be created using
     the <em>targeted</em> version of the next release and not just the value of the
     last, tagged commit.</p>
</li>
</ol></div>
        </div>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <!--
        <script src="../../.themes/yeti/js/base.js"></script>
        <script src="../../.themes/yeti/js/bootstrap-3.0.3.min.js"></script>
        <script src="../../.themes/yeti/js/highlight.pack.js"></script>
        <script src="../../.themes/yeti/js/jquery-1.10.2.min.js"></script>
        -->
    </body>

</html>